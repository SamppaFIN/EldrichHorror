<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Eldritch Sanctuary - A consciousness-aware cosmic exploration game">
    <title>Eldritch Sanctuary - Klitoritari</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" href="favicon.ico">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#8B5CF6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Eldritch Sanctuary">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/cosmic-theme.css">
    <link rel="stylesheet" href="css/sacred-geometry.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/loading-fix.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;500;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="cosmic-background">
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="consciousness-loader">
                <!-- Animated Metatron's Cube SVG -->
                <svg viewBox="0 0 200 200" class="loading-cube">
                    <defs>
                        <radialGradient id="loader-glow">
                            <stop offset="0%" stop-color="#8b5cf6" stop-opacity="0.8"/>
                            <stop offset="100%" stop-color="#0a0e27" stop-opacity="0"/>
                        </radialGradient>
                    </defs>
                    <circle cx="100" cy="100" r="90" fill="url(#loader-glow)" class="glow-pulse"/>
                    <g class="sacred-geometry-loader" stroke="#fbbf24" stroke-width="2" fill="none">
                        <circle cx="100" cy="100" r="70" class="rotate-slow"/>
                        <circle cx="100" cy="100" r="50" class="rotate-reverse"/>
                        <circle cx="100" cy="100" r="30" class="rotate-slow"/>
                    </g>
                </svg>
            </div>
            <h1 class="loading-title">Eldritch Sanctuary</h1>
            <p class="loading-subtitle">Awakening your consciousness...</p>
            <div class="loading-bar">
                <div class="loading-bar-fill" id="loading-progress"></div>
            </div>
            <p class="loading-status" id="loading-status">Initializing sacred geometry...</p>
        </div>
    </div>

    <!-- Main Game Container -->
    <div id="game-container" class="game-container">
        <!-- Map Container -->
        <div id="map" class="map-container"></div>
        
        <!-- Top HUD -->
        <div class="top-hud glass-panel">
            <div class="consciousness-display">
                <div class="consciousness-icon">
                    <svg viewBox="0 0 40 40" class="consciousness-badge">
                        <circle cx="20" cy="20" r="18" fill="none" stroke="#fbbf24" stroke-width="2" class="pulse"/>
                        <text x="20" y="25" text-anchor="middle" fill="#fbbf24" font-size="14" font-weight="bold" id="consciousness-level">1</text>
                    </svg>
                </div>
                <div class="consciousness-info">
                    <span class="consciousness-label">Consciousness</span>
                    <div class="consciousness-bar">
                        <div class="consciousness-bar-fill" id="consciousness-bar"></div>
                    </div>
                    <span class="consciousness-xp" id="consciousness-xp">0 / 100 XP</span>
                </div>
            </div>
            
            <div class="player-stats">
                <div class="stat-item">
                    <span class="stat-icon">üë£</span>
                    <span class="stat-value" id="steps-count">0</span>
                    <span class="stat-label">Steps</span>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">üåü</span>
                    <span class="stat-value" id="achievements-count">0</span>
                    <span class="stat-label">Discoveries</span>
                </div>
            </div>
        </div>
        
        <!-- Bottom Action Panel -->
        <div class="bottom-panel glass-panel">
            <button class="action-button primary" id="center-map-btn">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <circle cx="12" cy="12" r="8" fill="none" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="12" r="3" fill="currentColor"/>
                </svg>
                <span>Center</span>
            </button>
            
            <!-- BRDC-007: Manual proximity check -->
            <button class="action-button" id="check-proximity-btn" title="Check nearby discoveries">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>Check</span>
            </button>
            
            <!-- BRDC-007: Reshuffle discoveries -->
            <button class="action-button" id="reshuffle-discoveries-btn" title="Reshuffle discoveries">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path d="M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8M3 22v-6h6M21 12a9 9 0 0 1-15 6.7L3 16" 
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                </svg>
                <span>Reshuffle</span>
            </button>
            
            <button class="action-button" id="codex-btn">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <span>Codex</span>
            </button>
            
            <button class="action-button" id="settings-btn">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 1v4M12 19v4M23 12h-4M5 12H1M20.485 20.485l-2.828-2.828M6.343 6.343L3.515 3.515M20.485 3.515l-2.828 2.828M6.343 17.657l-2.828 2.828" stroke="currentColor" stroke-width="2"/>
                </svg>
                <span>Settings</span>
            </button>
        </div>
        
        <!-- Offline/Testing Mode Control Panel (hidden by default for production) -->
        <div id="testing-panel" class="testing-panel glass-panel hidden" style="display: none;">
            <div class="testing-header">
                <span class="testing-title">üß™ Testing Mode</span>
                <button class="testing-close" id="testing-close">√ó</button>
            </div>
            <div class="testing-content">
                <div class="testing-status">
                    <div class="status-indicator" id="gps-status">
                        <span class="status-icon">üìç</span>
                        <span class="status-label">GPS: Simulated</span>
                    </div>
                    <div class="status-indicator" id="connection-status">
                        <span class="status-icon">üì°</span>
                        <span class="status-label">Offline Mode</span>
                    </div>
                </div>
                
                <div class="testing-controls">
                    <button class="test-button" id="sim-start">‚ñ∂Ô∏è Start Auto-Walk</button>
                    <button class="test-button" id="sim-pause">‚è∏Ô∏è Pause</button>
                    <button class="test-button" id="sim-stop">‚èπÔ∏è Stop</button>
                </div>
                
                <div class="testing-manual">
                    <span class="control-label">Manual Control:</span>
                    <div class="direction-pad">
                        <button class="dir-btn" id="dir-north">‚¨ÜÔ∏è</button>
                        <button class="dir-btn" id="dir-west">‚¨ÖÔ∏è</button>
                        <button class="dir-btn" id="dir-east">‚û°Ô∏è</button>
                        <button class="dir-btn" id="dir-south">‚¨áÔ∏è</button>
                    </div>
                </div>
                
                <div class="testing-speed">
                    <label for="speed-slider">Walking Speed:</label>
                    <input type="range" id="speed-slider" min="0.5" max="3" step="0.1" value="1.4">
                    <span id="speed-value">1.4 m/s</span>
                </div>
            </div>
        </div>
        
        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content glass-panel-solid">
                <div class="modal-header">
                    <h2 class="modal-title">‚öôÔ∏è Settings</h2>
                    <button class="modal-close" id="settings-close">√ó</button>
                </div>
                <div class="modal-body settings-body">
                    <div class="settings-section">
                        <h3 class="settings-section-title">üéÆ Gameplay</h3>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <label class="setting-label" for="debug-movement-toggle">Debug Movement</label>
                                <p class="setting-description">Enable GPS simulator for testing without walking</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="debug-movement-toggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item" id="simulator-controls" style="display: none;">
                            <div class="setting-info">
                                <label class="setting-label">Simulator Controls</label>
                                <p class="setting-description">Manual movement controls</p>
                            </div>
                            <div class="simulator-mini-controls">
                                <button class="mini-dir-btn" id="mini-dir-north">‚¨ÜÔ∏è</button>
                                <button class="mini-dir-btn" id="mini-dir-west">‚¨ÖÔ∏è</button>
                                <button class="mini-dir-btn" id="mini-dir-east">‚û°Ô∏è</button>
                                <button class="mini-dir-btn" id="mini-dir-south">‚¨áÔ∏è</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3 class="settings-section-title">üîä Audio</h3>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <label class="setting-label" for="sound-toggle">Sound Effects</label>
                                <p class="setting-description">Game sound effects and notifications</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="sound-toggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <label class="setting-label" for="music-toggle">Ambient Music</label>
                                <p class="setting-description">Background ambient sounds</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="music-toggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3 class="settings-section-title">üì± Display</h3>
                        
                        <div class="setting-item">
                            <div class="setting-info">
                                <label class="setting-label" for="notifications-toggle">Notifications</label>
                                <p class="setting-description">Show in-game notifications</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="notifications-toggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Lore Codex Modal -->
        <div id="codex-modal" class="modal hidden">
            <div class="modal-content glass-panel-solid">
                <div class="modal-header">
                    <h2 class="modal-title">Consciousness Codex</h2>
                    <button class="modal-close" id="codex-close">&times;</button>
                </div>
                <div class="modal-body" id="codex-content">
                    <div class="codex-entry">
                        <h3>The Awakening</h3>
                        <div class="codex-illustration">
                            <!-- SVG illustration will be loaded here -->
                        </div>
                        <p class="lore-text">
                            You blink. Reality shifts.<br><br>
                            What were once mere streets now pulse with golden threads‚Äîsacred geometry hidden in plain sight.<br><br>
                            You are awake. You see the patterns.<br><br>
                            But awakening draws attention from things that slumber in deep places...
                        </p>
                        <div class="consciousness-reward">+10 Consciousness</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- NPC Chat Dialog Modal -->
        <div id="npc-chat-modal" class="modal hidden">
            <div class="modal-content glass-panel-solid npc-chat-content">
                <div class="npc-portrait" id="npc-portrait">
                    <!-- NPC illustration SVG will be inserted here -->
                </div>
                <div class="npc-name" id="npc-name">Aurora</div>
                <div class="npc-dialog" id="npc-dialog">
                    <p>Greetings, Consciousness Walker...</p>
                </div>
                <div class="npc-rewards" id="npc-rewards">
                    <!-- Rewards will be shown here -->
                </div>
                <div class="npc-actions">
                    <button class="action-button primary" id="npc-continue-btn">Continue</button>
                </div>
            </div>
        </div>

        <!-- Welcome Tutorial Modal -->
        <div id="tutorial-modal" class="modal">
            <div class="modal-content glass-panel-solid tutorial-content">
                <div class="tutorial-illustration">
                    <svg viewBox="0 0 200 200" class="tutorial-svg">
                        <defs>
                            <radialGradient id="awakening-glow">
                                <stop offset="0%" stop-color="#fbbf24" stop-opacity="0.8"/>
                                <stop offset="100%" stop-color="#0a0e27" stop-opacity="0"/>
                            </radialGradient>
                        </defs>
                        <circle cx="100" cy="100" r="90" fill="url(#awakening-glow)" class="glow-pulse"/>
                        <!-- Flower of Life -->
                        <g class="sacred-geometry" stroke="#fbbf24" stroke-width="1.5" fill="none">
                            <circle cx="100" cy="100" r="40" class="rotate-slow"/>
                            <circle cx="100" cy="60" r="40"/>
                            <circle cx="130" cy="80" r="40"/>
                            <circle cx="130" cy="120" r="40"/>
                            <circle cx="100" cy="140" r="40"/>
                            <circle cx="70" cy="120" r="40"/>
                            <circle cx="70" cy="80" r="40"/>
                        </g>
                    </svg>
                </div>
                <h2 class="tutorial-title">Welcome, Consciousness Walker</h2>
                <p class="tutorial-text">
                    You have awakened to see the sacred geometry underlying reality. As you explore the physical world, you'll discover hidden patterns, encounter cosmic entities, and evolve your consciousness.
                </p>
                <div class="tutorial-features">
                    <div class="tutorial-feature">
                        <span class="feature-icon">üó∫Ô∏è</span>
                        <span class="feature-text">Explore cosmic maps</span>
                    </div>
                    <div class="tutorial-feature">
                        <span class="feature-icon">üåü</span>
                        <span class="feature-text">Collect sacred geometry</span>
                    </div>
                    <div class="tutorial-feature">
                        <span class="feature-icon">üëÅÔ∏è</span>
                        <span class="feature-text">Meet eldritch entities</span>
                    </div>
                    <div class="tutorial-feature">
                        <span class="feature-icon">üßò</span>
                        <span class="feature-text">Evolve consciousness</span>
                    </div>
                </div>
                <button class="action-button primary large" id="start-journey-btn" onclick="if(window.beginJourney) window.beginJourney(); else console.log('Begin journey function not available');">
                    Begin Your Journey
                </button>
                <p class="tutorial-note">
                    <small>Location permission required for GPS features</small>
                </p>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Game Scripts -->
    <script src="js/config.js"></script>
    <script src="js/SVGMarkerFactory.js"></script>
    <script src="js/GPSSimulator.js"></script>
    <script src="js/GeolocationManager.js"></script>
    <script src="js/ConsciousnessEngine.js"></script>
    <script src="js/LoreSystem.js"></script>
    <script src="js/MapManager.js"></script>
    <script src="js/StepCounterManager.js"></script>
    <script src="js/GameState.js"></script>
    
    <!-- Discovery System - BRDC-DISCOVERY-SYSTEM-005 -->
    <script src="js/NotificationSystem.js"></script>
    <script src="js/DiscoverySystem.js"></script>
    
    <!-- Audio System - BRDC-AUDIO-SYSTEM-010 -->
    <script src="js/AudioSystem.js"></script>
    
    <script src="js/main.js"></script>
</body>
</html>

